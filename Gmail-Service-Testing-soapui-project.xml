<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project activeEnvironment="Default" name="Gmail Service Testing" resourceRoot="" soapui-version="5.0.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:testSuite name="Authorization"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Authorization" searchProperties="true" id="1622e7d3-28d1-4414-9fc2-2957db749391"><con:settings/><con:testStep type="httprequest" name="GetAccessToken"><con:settings/><con:config method="POST" xsi:type="con:HttpRequest" name="GetAccessToken" postQueryString="false" mediaType="application/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Content-Type" value="application/x-www-form-urlencoded" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>https://accounts.google.com/o/oauth2/token</con:endpoint><con:request>client_id=308595756412-98t4qurbstdao35ofphp1f20aiuavhsj.apps.googleusercontent.com&amp;client_secret=B1pmdPUXXb8aV7eYZ64SgnnD&amp;refresh_token=1/-5oIZKUz95xsY5Tx4Yy9zMznJSM9nOZ_5oo7A2NA8rM&amp;grant_type=refresh_token</con:request><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper

def response = new JsonSlurper().parseText(messageExchange.responseContent)

if(response.access_token != null &amp;&amp;  response.token_type != null)
{
	messageExchange.modelItem.testStep.testCase.testSuite.project.setPropertyValue('access_token', response.token_type + " " + response.access_token)
}
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties><con:property><con:name>access_token</con:name><con:value>Bearer ya29.cgDDhtO9tpmZnBwAAADCn3URqBFmvXnjVcDg4ZDXzQmkMpC4hRDsm7Rzyqms7Q</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite name="Messages"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="List" searchProperties="true" id="89da6e53-7ce0-41f6-82bd-347741d0e4dc"><con:settings/><con:testStep type="httprequest" name="List"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" name="List" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="authorization" value="${#Project#access_token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>https://www.googleapis.com/gmail/v1/users/${#Project#email}/messages</con:endpoint><con:request/><con:assertion type="Valid HTTP Status Codes" name="Valid HTTP Status Codes"><con:configuration><codes>200
</codes></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper

def response = new JsonSlurper().parseText(messageExchange.responseContent)

if(response.messages.size > 0)
{
	messageId = response.messages[0].id
	messageExchange.modelItem.testStep.testCase.setPropertyValue('messageId', messageId)
}

</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:testStep type="httprequest" name="Get"><con:settings/><con:config method="GET" xsi:type="con:HttpRequest" name="Get" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="authorization" value="${#Project#access_token}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>https://www.googleapis.com/gmail/v1/users/${#Project#email}/messages/1482bc104b15a47d</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:config></con:testStep><con:properties><con:property><con:name>messageId</con:name><con:value>148cbebba749e9e2</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>email</con:name><con:value>mrproper86@gmail.com</con:value></con:property><con:property><con:name>access_token</con:name><con:value>Bearer ya29.kQCWsggFwdaOUSL7OXwkgfxNvNm5vgt93lKDwRgqjyKIBrjwcHwSI1i2</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:sensitiveInformation/></con:soapui-project>